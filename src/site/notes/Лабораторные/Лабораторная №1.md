---
{"dg-publish":true,"permalink":"/laboratornye/laboratornaya-1/"}
---

#### 1. **Создание пользователей**

**1.1.** Создать 3 новых пользвателя (user1, user2, user3). Создать для них домашнии директории и установить shell-оболочку по умолчанию (/bin/sh)
![Pasted image 20250607181445.png](/img/user/Pasted%20image%2020250607181445.png)
Создал 3х пользователей user1, user2, user3



**1.2.** Проверить, что пользователи и домашние директории были созданы. Проверить группы, которым принадлежат пользователи.
![Pasted image 20250607181654.png](/img/user/Pasted%20image%2020250607181654.png)

![Pasted image 20250607181814.png](/img/user/Pasted%20image%2020250607181814.png)

![Pasted image 20250607181947.png](/img/user/Pasted%20image%2020250607181947.png)
Проверка показала, что все успешно создалось.



**1.3.** Просмотреть файл /etc/shadow, объяснить его структуру.
![Pasted image 20250607182040.png](/img/user/Pasted%20image%2020250607182040.png)
**Файл /etc/shadow содержит информацию о паролях пользователей в защищённой форме.** Каждая строка в этом файле относится к одному пользователю и состоит из следующих полей, разделённых двоеточиями:
1. Имя пользователя – логин пользователя в системе.
2. Хеш пароля – зашифрованный (хешированный) пароль пользователя. Если стоит символ * или !, это означает, что вход в систему для пользователя заблокирован.
3. Дата последнего изменения пароля – указывается количество дней, прошедших с 1 января 1970 года (начало эпохи Unix), когда последний раз был изменён пароль.
4. Минимальный срок действия пароля – минимальное количество дней, которые должны пройти после смены пароля, прежде чем его можно будет изменить снова. Если указано 0 – ограничений нет.
5. Максимальный срок действия пароля – сколько дней может использоваться текущий пароль до того, как потребуется его сменить.
6. Период предупреждения – за сколько дней до окончания срока действия пароля пользователь начнёт получать уведомления о необходимости его сменить.
7. Период бездействия – сколько дней после истечения срока действия пароля можно не менять его до того, как учётная запись будет отключена.
8. Дата отключения учётной записи – указано в виде количества дней с 1 января 1970 года. После этой даты пользователь не сможет войти в систему.
9. Зарезервированное поле – не используется в настоящее время, оставлено на будущее.

![Pasted image 20250607182312.png](/img/user/Pasted%20image%2020250607182312.png)
**ХЭШ пароля user_3 изменился, что свидетельствует и об изменении самого пароля.**



**1.4.** Создайте новую группу, которая будет включать двух из трех пользователей (user1, user2). Удалите группы тех пользователей, которых вы объединили (user1, user2).

![Pasted image 20250607182711.png](/img/user/Pasted%20image%2020250607182711.png)
Создал группу, проверил наличие.

![Pasted image 20250607183852.png](/img/user/Pasted%20image%2020250607183852.png)
Использую `vi /etc/passwd` в режиме insert, чтобы изменить Group ID пользователей на 1006 (как в группе group_12).

![Pasted image 20250607184056.png](/img/user/Pasted%20image%2020250607184056.png)
Удаление групп отдельных пользователей прошло успешно.



#### **2. Разрешения**

**2.1.** Авторизуйтесь под первым пользователем (user1). Создайте файл в домашней директории пользователя, проверьте разрешения по умолчанию.

![Pasted image 20250607202105.png](/img/user/Pasted%20image%2020250607202105.png)
Зашел под user_1

![Pasted image 20250607202231.png](/img/user/Pasted%20image%2020250607202231.png)
`-rw-r--r--` права пользователя user_1



**2.2.** Измените права таким образом, чтобы пользователь той же группы (user2) мог редактировать файл, а отдельный (user3) - не мог видеть и редактировать.

![Pasted image 20250607202549.png](/img/user/Pasted%20image%2020250607202549.png)
После этого все user из группы имеют права на запись и чтение в файле file.txt, а другие пользователи вне группы не имеют прав доступа к file.txt


**2.3.** Измените права на файл таким образом, чтобы владелец (user1) и отдельный пользватель (user3) могли читать и редактировать файл, а второй пользователь (user2) - нет.

![Pasted image 20250607202913.png](/img/user/Pasted%20image%2020250607202913.png)
Меняем 660 на 606, чтобы читать и редактировать файл могли только создатель и остальные вне группы. 4 - читать, 2 - записывать, порядок: владелец, группа, остальные.



**2.4.** Создайте директорию, поместите в нее несколько файлов. Повторите шаг 2.2 и 2.3 для директории и файлов внутри нее.

![Pasted image 20250607203314.png](/img/user/Pasted%20image%2020250607203314.png)
Создал папку, а в ней 3 файла

- 2.2  Измените права таким образом, чтобы пользователь той же группы (user2) мог редактировать файл, а отдельный (user3) - не мог видеть и редактировать. ![Pasted image 20250607203813.png](/img/user/Pasted%20image%2020250607203813.png)
- 2.3 Измените права на файл таким образом, чтобы владелец (user1) и отдельный пользватель (user3) могли читать и редактировать файл, а второй пользователь (user2) - нет. ![Pasted image 20250607204037.png](/img/user/Pasted%20image%2020250607204037.png) ![Pasted image 20250607204522.png](/img/user/Pasted%20image%2020250607204522.png)
Пришлось использовать `chmod u+x` к папке dir, чтобы у владельца была возможность execute папке. Зато это дает понять, что права на чтение папки не дают права на чтение файлов внутри, для всего нужно использовать отдельные команды (возможно есть специализированные для папок, но я не нашел)



**2.5** Создайте скрипт на ЯП Python с расширением `.py`. Задайте ему шебанг. Попробуйте запустить скрипт самостоятельно, без вызова интерпретатора.

![Pasted image 20250607222001.png](/img/user/Pasted%20image%2020250607222001.png)
`#!` это шебанг, который показывает каким интерпретатором запускать скрипт

![Pasted image 20250607222720.png](/img/user/Pasted%20image%2020250607222720.png)
С помощью `chmod +x` дал права файлу и запустил, для загрузки python использовал `apk add python3`



#### 3. **Специальные разрешения**



**3.1** Что делает команда `chmod 4762 filename`?

- 1 цифра - Set User ID (setuid)
- Остальные три - обычные права (как до этого)

Когда установлен `setuid` (4xxx), и **файл исполняемый**, то **он запускается с правами владельца файла**, а не пользователя, который его запускает.

Важно:
- `setuid` имеет эффект только на исполняемых файлах (например, скриптах или бинарниках).
- На папках он не работает.



**3.2** Зайдите под первым пользователем (user1) и создайте директорию (например, dir1), внутрь поместите несколько исполняемых скриптов с расщирением .py. Для этой директории рекурсивно установите UID, GID и Sticky Bit. Дайте скриптам права на исполнение.

![Pasted image 20250607224931.png](/img/user/Pasted%20image%2020250607224931.png)
Создал папку, добавил три скрипта, изменил права. Вместо `x` указан `s`. Это значит, что **SETUID**, позволяет при исполнении файла использовать **UID** владельца.

![Pasted image 20250607225357.png](/img/user/Pasted%20image%2020250607225357.png)
Все успешно исполняется.



**3.3** **Удалите права на исполнения для всего в домашней директории.**

![Pasted image 20250607225538.png](/img/user/Pasted%20image%2020250607225538.png)
 - Как изменился вывод **ls -l**?

После удаления прав на исполнение s поменялось на S ( **setuid** бит установлен, но файлы не имеют права на исполнение (`x`)), t поменялось на T (**sticky bit** установлен, но директория не имеет права на исполнение (`x`))



**3.4** **Установите для созданной директории (dir1) права таким образом, чтобы пользователи из других групп могли осуществлять навигацию и читать файлы внутри.**

![Pasted image 20250607225924.png](/img/user/Pasted%20image%2020250607225924.png)

![Pasted image 20250607230241.png](/img/user/Pasted%20image%2020250607230241.png)
Изменили владельца на user_3

Директория `dir_1` теперь будет принадлежать группе с идентификатором 1003.

Права доступа владельца остаются неизменными (например, `rwx`)  
Права доступа для группы (`rw-`) теперь применяются к пользователям, входящим в группу `1003`

**3.5** **Авторизуйтесь в системе под вторым пользователем (user2) и создайте директорию {user2}share. Установите разрешения таким образом, чтобы второй пользователь мог делиться файлами с первым (user1) и отдельным (user3)**.

Первый пользователь (**user1**) и отдельный (**user3**) могут читать файлы, создавать и осуществлять навигацию, но не могут редактировать, переименовывать и удалять файлы никакие, кроме своих.

![Pasted image 20250607230728.png](/img/user/Pasted%20image%2020250607230728.png)
![Pasted image 20250607230753.png](/img/user/Pasted%20image%2020250607230753.png)


![Pasted image 20250607231114.png](/img/user/Pasted%20image%2020250607231114.png)
Логинимся, владелец папки user_2. user_1 и user_3 могут читать и выполнять для этой папки.

user_2 может создавать, редактировать, удалять и переименовывать любые файлы в директории. В свою очередь user_1 и user_3 могут читать, создавать новые файлы, переходить по директории. При этом не могут удалять и переименовывать и редактировать файлы созданные другими пользователями.



**3.6. Создайте файл sensetive_data от имени второго пользователя (user2) и запишите в него какую-либо текстовую информацию. Уберите разрешения для группы и всех остальных.**

 - Авторизуйтесь под отдельным пользователем (user3), попытайтесь прочитать файл **sensetive_data** с помощью утилиты **cat**. ![Pasted image 20250607231949.png](/img/user/Pasted%20image%2020250607231949.png)
 Создали echo, залогинились под user_3
 ![Pasted image 20250607232153.png](/img/user/Pasted%20image%2020250607232153.png)
 С помощью cat не получилось открыть, вероятно потому что у него нет прав.
 
 - Попытайтесь прочитать файл с помощью утилиты **vi**.

С помощью утилиты vi не получилось увидеть содержимое. Как будто открылся пустой файл.

 - Установите SUID bit на **vi** (от имени суперпользователя). ![Pasted image 20250607232743.png](/img/user/Pasted%20image%2020250607232743.png)
 - Попробуйте снова прочитать файл под отдельным пользователем (**user3**). ![Pasted image 20250607232916.png](/img/user/Pasted%20image%2020250607232916.png) ![Pasted image 20250607233144.png](/img/user/Pasted%20image%2020250607233144.png)
 Все равно не открывается, если делать не через рута.

VIM:
Использовал chmod на /usr/bin/vim

![Pasted image 20250607234024.png](/img/user/Pasted%20image%2020250607234024.png)
![Pasted image 20250607234647.png](/img/user/Pasted%20image%2020250607234647.png)

![Pasted image 20250607234218.png](/img/user/Pasted%20image%2020250607234218.png)

Все получилось через VIM